## Mysql使用了索引就一定有效吗？如何排查

不一定有效。

以下场景就会导致索引失效

对于联合索引

* 违反最左匹配原则
* 使用了> < 查询 导致右边的索引失效

对于单个索引

* like %x 的使用
* 对索引进行运算（使用函数）以及类型隐式转化。
* order by  后面不是主键或者不是覆盖索引
* or  两者中要都是索引才能生效



索引失效的原因

总的来说就是在索引构建的时候都是有序的，在使用索引进行查询的时候如果不能和有序的索引结构匹配那就会导致索引失效。



可以使用EXPlAIN 来排查

1. 通过key和key_len看是否命中了索引
2. 通过type字段看sql是否由优化的空间，避免all,index 全盘扫描
3. 通过extra 看是否出现回表，若出现会表可以使用修改返回的所需字段或者使用联合索引。